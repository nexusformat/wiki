


<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>NXbrowse.f90</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css?v=34905f61" />
    <link rel="stylesheet" type="text/css" href="_static/details_summary_hide.css?v=30df4bca" />
    <link rel="stylesheet" href="_static/blockquote.css" type="text/css" />
    <link rel="stylesheet" href="_static/rubric.css" type="text/css" />
    <script src="_static/documentation_options.js?v=b08bce9f"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="https://raw.githubusercontent.com/nexusformat/NIAC/master/NeXus_Logo/NeXus_Logo_dark_square.svg"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="NXbrowse" href="NXbrowse.html" />
    <link rel="prev" title="NXaperture and Slits" href="NXaperture_and_Slits.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="NXbrowse.html" title="NXbrowse"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="NXaperture_and_Slits.html" title="NXaperture and Slits"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html"></a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NXbrowse.f90</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="nxbrowse-f90">
<h1>NXbrowse.f90<a class="headerlink" href="#nxbrowse-f90" title="Link to this heading">Â¶</a></h1>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c">!------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! NeXus - Neutron &amp; X-ray Common Data Format</span>
<span class="w">    </span><span class="c">!  </span>
<span class="w">    </span><span class="c">! Fortran 90 Browser</span>
<span class="w">    </span><span class="c">!</span>
<span class="w">    </span><span class="c">! Copyright (C) 1999, Ray Osborn</span>
<span class="w">    </span><span class="c">!</span>
<span class="w">    </span><span class="c">! This library is free software; you can redistribute it and/or</span>
<span class="w">    </span><span class="c">! modify it under the terms of the GNU Lesser General Public</span>
<span class="w">    </span><span class="c">! License as published by the Free Software Foundation; either</span>
<span class="w">    </span><span class="c">! version 2 of the License, or (at your option) any later version.</span>
<span class="w">    </span><span class="c">!</span>
<span class="w">    </span><span class="c">! This library is distributed in the hope that it will be useful,</span>
<span class="w">    </span><span class="c">! but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="w">    </span><span class="c">! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="w">    </span><span class="c">! Lesser General Public License for more details.</span>
<span class="w">    </span><span class="c">!</span>
<span class="w">    </span><span class="c">! You should have received a copy of the GNU Lesser General Public</span>
<span class="w">    </span><span class="c">! License along with this library; if not, write to the Free Software</span>
<span class="w">    </span><span class="c">! Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<span class="w">    </span><span class="c">!</span>
<span class="w">    </span><span class="c">! Contact : R. Osborn &lt;ROsborn@anl.gov&gt;</span>
<span class="w">    </span><span class="c">!           Materials Science Division</span>
<span class="w">    </span><span class="c">!           Argonne National Laboratory</span>
<span class="w">    </span><span class="c">!           Argonne, IL 60439-4845</span>
<span class="w">    </span><span class="c">!           USA</span>
<span class="w">    </span><span class="c">!</span>
<span class="w">    </span><span class="c">! For further information, see &lt;http://www.neutron.anl.gov/NeXus/&gt;</span>
<span class="w">    </span><span class="c">!</span>
<span class="w">    </span><span class="c">!$Id: NXbrowse.f90,v 1.6 1999/11/24 16:30:12 nexus Exp $</span>
<span class="w">    </span><span class="c">!------------------------------------------------------------------------------</span>

<span class="w">    </span><span class="k">program </span><span class="n">NXbrowse</span>

<span class="w">       </span><span class="k">use </span><span class="n">NXUmodule</span>
<span class="w">       </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">file_name</span><span class="p">,</span><span class="w"> </span><span class="n">input_text</span><span class="p">,</span><span class="w"> </span><span class="n">path</span>
<span class="w">       </span><span class="k">type</span><span class="p">(</span><span class="n">NXhandle</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">file_id</span>
<span class="w">       </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">NX_MAXNAMELEN</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">name</span><span class="p">(:),</span><span class="w"> </span><span class="k">class</span><span class="p">(:)</span>
<span class="w">       </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">NX_MAXNAMELEN</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">group_name</span><span class="p">,</span><span class="w"> </span><span class="n">group_class</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span>
<span class="w">       </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">NXrank</span><span class="p">,</span><span class="w"> </span><span class="n">NXtype</span><span class="p">,</span><span class="w"> </span><span class="n">NXdims</span><span class="p">(</span><span class="n">NX_MAXRANK</span><span class="p">)</span>
<span class="w">       </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">single_element</span>
<span class="w">       </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">char_value</span>
<span class="w">       </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">NXi4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">int_value</span>
<span class="w">       </span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">NXi4</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">int_array</span><span class="p">(:),</span><span class="w"> </span><span class="n">int_2Darray</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">int_3Darray</span><span class="p">(:,:,:)</span>
<span class="w">       </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">NXr4</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">real_value</span>
<span class="w">       </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">NXr4</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">real_array</span><span class="p">(:),</span><span class="w"> </span><span class="n">real_2Darray</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">real_3Darray</span><span class="p">(:,:,:)</span>
<span class="w">       </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">NXr8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dble_value</span>
<span class="w">       </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">NXr8</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dble_array</span><span class="p">(:),</span><span class="w"> </span><span class="n">dble_2Darray</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">dble_3Darray</span><span class="p">(:,:,:)</span>

<span class="w">       </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=*</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;(a)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">advance</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot; Give name of NeXus file : &quot;</span>
<span class="w">       </span><span class="k">read</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">file_name</span>
<span class="w">    </span><span class="c">!Open input file and output global attributes</span>
<span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXopen</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">file_name</span><span class="p">),</span><span class="w"> </span><span class="n">NXACC_READ</span><span class="p">,</span><span class="w"> </span><span class="n">file_id</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          call </span><span class="n">NXerror</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;Can&#39;t open &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
<span class="w">          </span><span class="k">stop</span>
<span class="k">       end if</span>
<span class="k">       do</span>
<span class="k">          </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NXgetnextattr</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">NXtype</span><span class="p">)</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="w">          </span><span class="c">!Output attribute information according to type</span>
<span class="w">          </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">NXtype</span><span class="p">)</span>
<span class="w">             </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_CHAR</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXgetattr</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">,</span><span class="w"> </span><span class="n">char_value</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">                   print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;    &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; = &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">char_value</span><span class="p">)</span>
<span class="w">                   </span><span class="n">char_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot; &quot;</span>
<span class="w">             </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_INT8</span><span class="p">,</span><span class="n">NX_UINT8</span><span class="p">,</span><span class="n">NX_INT16</span><span class="p">,</span><span class="n">NX_UINT16</span><span class="p">,</span><span class="n">NX_INT32</span><span class="p">,</span><span class="n">NX_UINT32</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXgetattr</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">,</span><span class="w"> </span><span class="n">int_value</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                   print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;    &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; = &quot;</span><span class="p">,</span><span class="n">int_value</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">             case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_FLOAT32</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXgetattr</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">,</span><span class="w"> </span><span class="n">real_value</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                   print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;    &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; = &quot;</span><span class="p">,</span><span class="n">real_value</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">             case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_FLOAT64</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXgetattr</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">,</span><span class="w"> </span><span class="n">dble_value</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                   print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;    &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; = &quot;</span><span class="p">,</span><span class="n">dble_value</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">          end select</span>
<span class="k">       end do</span>
<span class="w">    </span><span class="c">!Input commands until the EXIT command is given</span>
<span class="w">       </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;NX&quot;</span>
<span class="w">       </span><span class="k">do</span>
<span class="k">          write</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=*</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;(a)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">advance</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;&gt; &quot;</span>
<span class="w">          </span><span class="k">read</span><span class="w"> </span><span class="s2">&quot;(a)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">input_text</span>
<span class="w">          </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">command</span><span class="p">(</span><span class="n">input_text</span><span class="p">))</span>
<span class="w">             </span><span class="c">!Command is to print a directory of the current group</span>
<span class="w">             </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;DIR&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXgetgroupinfo</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">                allocate</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="k">class</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="w">                </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NXgroupdir</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">class</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                   do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
<span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">class</span><span class="p">(</span><span class="n">i</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;NX&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                         print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  NX Group : &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">name</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; (&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="k">class</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot;)&quot;</span>
<span class="w">                      </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="k">class</span><span class="p">(</span><span class="n">i</span><span class="p">)(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;SDS&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                         print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  NX Data  : &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">name</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">                      </span><span class="k">end if</span>
<span class="k">                   end do</span>
<span class="k">                end if</span>
<span class="k">                deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">class</span><span class="p">)</span>
<span class="w">             </span><span class="c">!Command is to open the specified group</span>
<span class="w">             </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;OPEN&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="n">input_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">adjustl</span><span class="p">(</span><span class="n">input_text</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">input_text</span><span class="p">)))</span>
<span class="w">                </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">input_text</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">index</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)),</span><span class="w"> </span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;(a)&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">group_name</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUfindgroup</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">group_name</span><span class="p">,</span><span class="w"> </span><span class="n">group_class</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_EOD</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                   call </span><span class="n">NXerror</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">group_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not exist&quot;</span><span class="p">)</span>
<span class="w">                   </span><span class="k">cycle</span>
<span class="k">                end if</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">NXopengroup</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">group_name</span><span class="p">,</span><span class="w"> </span><span class="n">group_class</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="w">                </span><span class="c">!Add the group to the prompt string</span>
<span class="w">                </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">group_name</span><span class="p">)</span>
<span class="w">             </span><span class="c">!Command is to print the values of the data</span>
<span class="w">             </span><span class="c">!1) if the array index is specified, a single element is output</span>
<span class="w">             </span><span class="c">!2) if no index is given, the minimum and maximum values of the array are output</span>
<span class="w">             </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;READ&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="n">input_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">adjustl</span><span class="p">(</span><span class="n">input_text</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">input_text</span><span class="p">)))</span>
<span class="w">                </span><span class="c">!Check for evidence that an individual element has been specified</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                   read</span><span class="w"> </span><span class="p">(</span><span class="n">input_text</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">index</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">)),</span><span class="w"> </span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;(a)&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">data_name</span>
<span class="w">                   </span><span class="n">single_element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">                </span><span class="k">else</span>
<span class="k">                   read</span><span class="w"> </span><span class="p">(</span><span class="n">input_text</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">index</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;(a)&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">data_name</span>
<span class="w">                   </span><span class="n">single_element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">                </span><span class="k">end if</span>
<span class="w">                </span><span class="c">!Check the specified data item exists</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUfinddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_EOD</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                   call </span><span class="n">NXerror</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; does not exist&quot;</span><span class="p">)</span>
<span class="w">                   </span><span class="k">cycle</span>
<span class="k">                end if</span>
<span class="w">                </span><span class="c">!Open the data and obtain its type and rank details</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXopendata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">NXgetinfo</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">NXrank</span><span class="p">,</span><span class="w"> </span><span class="n">NXdims</span><span class="p">,</span><span class="w"> </span><span class="n">NXtype</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                   </span><span class="n">input_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input_text</span><span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="nb">index</span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span><span class="s2">&quot;)&quot;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dimcount</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NXrank</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                      call </span><span class="n">NXerror</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;Invalid array index&quot;</span><span class="p">)</span>
<span class="w">                      </span><span class="k">cycle</span>
<span class="k">                   end if</span>
<span class="k">                   read</span><span class="w"> </span><span class="p">(</span><span class="n">input_text</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="n">NXdims</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NXrank</span><span class="p">)</span>
<span class="w">                </span><span class="k">end if</span>
<span class="w">                </span><span class="c">!Output data according to data type</span>
<span class="w">                </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">NXtype</span><span class="p">)</span>
<span class="w">                   </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_CHAR</span><span class="p">)</span>
<span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">char_value</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">                      print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">char_value</span><span class="p">)</span>
<span class="w">                      </span><span class="n">char_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot; &quot;</span>
<span class="w">                   </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_INT8</span><span class="p">,</span><span class="n">NX_UINT8</span><span class="p">,</span><span class="n">NX_INT16</span><span class="p">,</span><span class="n">NX_UINT16</span><span class="p">,</span><span class="n">NX_INT32</span><span class="p">,</span><span class="n">NX_UINT32</span><span class="p">)</span>
<span class="w">                      </span><span class="c">!Output data according to rank</span>
<span class="w">                      </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">NXrank</span><span class="p">)</span>
<span class="w">                         </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">int_array</span><span class="p">,</span><span class="w"> </span><span class="n">data_start</span><span class="o">=</span><span class="n">NXdims</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;(&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;) [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">int_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            else</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">int_array</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">int_array</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                     print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                     </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">int_array</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; to &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">int_array</span><span class="p">)</span>
<span class="w">                                  </span><span class="k">else</span>
<span class="k">                                     print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                     </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">int_array</span>
<span class="w">                                  </span><span class="k">end if</span>
<span class="k">                               end if</span>
<span class="k">                            end if</span>
<span class="k">                            deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">int_array</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">                         </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">int_2Darray</span><span class="p">,</span><span class="w"> </span><span class="n">data_start</span><span class="o">=</span><span class="n">NXdims</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">int_2Darray</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            else</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">int_2Darray</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">int_2Darray</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; to &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">int_2Darray</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            end if</span>
<span class="k">                            deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">int_2Darray</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">                         </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">int_3Darray</span><span class="p">,</span><span class="w"> </span><span class="n">data_start</span><span class="o">=</span><span class="n">NXdims</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">int_3Darray</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            else</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">int_3Darray</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">int_3Darray</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; to &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">int_3Darray</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            end if</span>
<span class="k">                            deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">int_3Darray</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">                      </span><span class="k">end select</span>
<span class="k">                   case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_FLOAT32</span><span class="p">)</span>
<span class="w">                      </span><span class="c">!Output data according to rank</span>
<span class="w">                      </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">NXrank</span><span class="p">)</span>
<span class="w">                         </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">real_array</span><span class="p">,</span><span class="w"> </span><span class="n">data_start</span><span class="o">=</span><span class="n">NXdims</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;(&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;) [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">real_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            else</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">real_array</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">real_array</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                     print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                     </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">real_array</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; to &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">real_array</span><span class="p">)</span>
<span class="w">                                  </span><span class="k">else</span>
<span class="k">                                     print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                     </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">real_array</span>
<span class="w">                                  </span><span class="k">end if</span>
<span class="k">                               end if</span>
<span class="k">                            end if</span>
<span class="k">                            deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">real_array</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">                         </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">real_2Darray</span><span class="p">,</span><span class="w"> </span><span class="n">data_start</span><span class="o">=</span><span class="n">NXdims</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">real_2Darray</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            else</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">real_2Darray</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">real_2Darray</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; to &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">real_2Darray</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            end if</span>
<span class="k">                            deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">real_2Darray</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">                         </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">real_3Darray</span><span class="p">,</span><span class="w"> </span><span class="n">data_start</span><span class="o">=</span><span class="n">NXdims</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">real_3Darray</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            else</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">real_3Darray</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">real_3Darray</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; to &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">real_3Darray</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            end if</span>
<span class="k">                            deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">real_3Darray</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">                         </span><span class="k">end select</span>
<span class="k">                   case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_FLOAT64</span><span class="p">)</span>
<span class="w">                      </span><span class="c">!Output data according to rank</span>
<span class="w">                      </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">NXrank</span><span class="p">)</span>
<span class="w">                         </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">dble_array</span><span class="p">,</span><span class="w"> </span><span class="n">data_start</span><span class="o">=</span><span class="n">NXdims</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;(&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;) [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dble_array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            else</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">dble_array</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">dble_array</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                     print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                     </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">dble_array</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; to &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">dble_array</span><span class="p">)</span>
<span class="w">                                  </span><span class="k">else</span>
<span class="k">                                     print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                     </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dble_array</span>
<span class="w">                                  </span><span class="k">end if</span>
<span class="k">                               end if</span>
<span class="k">                            end if</span>
<span class="k">                            deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">dble_array</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">                         </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">dble_2Darray</span><span class="p">,</span><span class="w"> </span><span class="n">data_start</span><span class="o">=</span><span class="n">NXdims</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dble_2Darray</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            else</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">dble_2Darray</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">dble_2Darray</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; to &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">dble_2Darray</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            end if</span>
<span class="k">                            deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">dble_2Darray</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">                         </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">dble_3Darray</span><span class="p">,</span><span class="w"> </span><span class="n">data_start</span><span class="o">=</span><span class="n">NXdims</span><span class="p">,</span><span class="w"> </span><span class="n">data_size</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dble_3Darray</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            else</span>
<span class="k">                               if</span><span class="w"> </span><span class="p">(</span><span class="n">NXUreaddata</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">data_name</span><span class="p">,</span><span class="w"> </span><span class="n">dble_3Darray</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;  &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">data_name</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">dimstring</span><span class="p">(</span><span class="n">NXrank</span><span class="p">,</span><span class="n">NXdims</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot; [&quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">NXdatatype</span><span class="p">(</span><span class="n">NXtype</span><span class="p">))&amp;</span>
<span class="w">                                  </span><span class="o">//</span><span class="s2">&quot;] = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">minval</span><span class="p">(</span><span class="n">dble_3Darray</span><span class="p">),</span><span class="w"> </span><span class="s2">&quot; to &quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">maxval</span><span class="p">(</span><span class="n">dble_3Darray</span><span class="p">)</span>
<span class="w">                               </span><span class="k">end if</span>
<span class="k">                            end if</span>
<span class="k">                            deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">dble_3Darray</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="p">)</span>
<span class="w">                      </span><span class="k">end select</span>
<span class="k">                end select</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">single_element</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="w">                </span><span class="c">!Check for attributes</span>
<span class="w">                </span><span class="k">do</span>
<span class="k">                   </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NXgetnextattr</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">NXtype</span><span class="p">)</span>
<span class="w">                   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="w">                   </span><span class="c">!Output attribute information according to type</span>
<span class="w">                   </span><span class="k">select case</span><span class="w"> </span><span class="p">(</span><span class="n">NXtype</span><span class="p">)</span>
<span class="w">                      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_CHAR</span><span class="p">)</span>
<span class="w">                         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXgetattr</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">,</span><span class="w"> </span><span class="n">char_value</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="k">                         print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;    &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; = &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">char_value</span><span class="p">)</span>
<span class="w">                         </span><span class="n">char_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot; &quot;</span>
<span class="w">                      </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_INT8</span><span class="p">,</span><span class="n">NX_UINT8</span><span class="p">,</span><span class="n">NX_INT16</span><span class="p">,</span><span class="n">NX_UINT16</span><span class="p">,</span><span class="n">NX_INT32</span><span class="p">,</span><span class="n">NX_UINT32</span><span class="p">)</span>
<span class="w">                         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXgetattr</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">,</span><span class="w"> </span><span class="n">int_value</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;    &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; = &quot;</span><span class="p">,</span><span class="n">int_value</span>
<span class="w">                         </span><span class="k">end if</span>
<span class="k">                      case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_FLOAT32</span><span class="p">)</span>
<span class="w">                         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXgetattr</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">,</span><span class="w"> </span><span class="n">real_value</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;    &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; = &quot;</span><span class="p">,</span><span class="n">real_value</span>
<span class="w">                         </span><span class="k">end if</span>
<span class="k">                      case</span><span class="w"> </span><span class="p">(</span><span class="n">NX_FLOAT64</span><span class="p">)</span>
<span class="w">                         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXgetattr</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">,</span><span class="w"> </span><span class="n">attr_name</span><span class="p">,</span><span class="w"> </span><span class="n">dble_value</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;    &quot;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot; = &quot;</span><span class="p">,</span><span class="n">dble_value</span>
<span class="w">                         </span><span class="k">end if</span>
<span class="k">                   end select</span>
<span class="k">                end do</span>
<span class="w">             </span><span class="c">!Command is to close the current group</span>
<span class="w">             </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;CLOSE&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NXclosegroup</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">NX_OK</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="w">                </span><span class="c">!Remove the group from the prompt string</span>
<span class="w">                </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">path</span><span class="p">(</span><span class="mi">1</span><span class="p">:(</span><span class="nb">index</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="n">back</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="w">             </span><span class="c">!Command is to print help information</span>
<span class="w">             </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;HELP&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;NXbrowse commands : DIR&quot;</span>
<span class="w">                </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;                    OPEN &lt;group_name&gt;&quot;</span>
<span class="w">                </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;                    READ &lt;data_name&gt;&quot;</span>
<span class="w">                </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;                    CLOSE&quot;</span>
<span class="w">                </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;                    HELP&quot;</span>
<span class="w">                </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;                    EXIT&quot;</span>
<span class="w">             </span><span class="c">!Command is to exit the program</span>
<span class="w">             </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;EXIT&quot;</span><span class="p">,</span><span class="s2">&quot;QUIT&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="k">exit</span>
<span class="k">          end select</span>
<span class="k">       end do</span>
<span class="k">       </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NXclose</span><span class="w"> </span><span class="p">(</span><span class="n">file_id</span><span class="p">)</span>

<span class="w">    </span><span class="k">contains</span>

<span class="w">       </span><span class="c">!Returns the first word of input text in upper case</span>
<span class="w">       </span><span class="k">function </span><span class="n">command</span><span class="w"> </span><span class="p">(</span><span class="n">input_text</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="w"> </span><span class="p">(</span><span class="n">output_text</span><span class="p">)</span>

<span class="w">          </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">input_text</span>
<span class="w">          </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">output_text</span>
<span class="w">          </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">letter</span>

<span class="w">          </span><span class="n">output_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot; &quot;</span>
<span class="w">          </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="nb">len_trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">input_text</span><span class="p">))</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">input_text</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="k">             </span><span class="n">letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ichar</span><span class="p">(</span><span class="n">input_text</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">))</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">letter</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">97</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">122</span><span class="p">)</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">letter</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">32</span>
<span class="w">             </span><span class="n">output_text</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">char</span><span class="p">(</span><span class="n">letter</span><span class="p">)</span>
<span class="w">          </span><span class="k">end do</span>

<span class="k">       end function </span><span class="n">command</span>

<span class="w">       </span><span class="c">!Outputs the specified dimensions as a formatted string</span>
<span class="w">       </span><span class="k">function </span><span class="n">dimstring</span><span class="w"> </span><span class="p">(</span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">dims</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

<span class="w">          </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span><span class="p">,</span><span class="w"> </span><span class="n">dims</span><span class="p">(:)</span>
<span class="w">          </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">string</span>
<span class="w">          </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">buffer</span>
<span class="w">          </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>

<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rank</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">             </span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot; &quot;</span>
<span class="w">          </span><span class="k">else</span>
<span class="k">             </span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;(&quot;</span>
<span class="w">             </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">rank</span>
<span class="w">                </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;(i10)&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">dims</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">                </span><span class="n">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="nb">adjustl</span><span class="p">(</span><span class="n">buffer</span><span class="p">))</span><span class="o">//</span><span class="s2">&quot;,&quot;</span>
<span class="w">             </span><span class="k">end do</span>
<span class="k">             </span><span class="n">string</span><span class="p">(</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">string</span><span class="p">):</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">string</span><span class="p">))</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;)&quot;</span>
<span class="w">          </span><span class="k">end if</span>

<span class="k">       end function </span><span class="n">dimstring</span>

<span class="w">       </span><span class="c">!Outputs the number of dimensions specified in an input string</span>
<span class="w">       </span><span class="k">function </span><span class="n">dimcount</span><span class="w"> </span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="w"> </span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>

<span class="w">          </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">string</span>
<span class="w">          </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rank</span>
<span class="w">          </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">          </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">number_found</span>

<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">verify</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">string</span><span class="p">),</span><span class="s2">&quot; 0123456789,&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">             </span><span class="n">rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">          </span><span class="k">else</span>
<span class="k">             </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">             </span><span class="n">rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">             </span><span class="n">number_found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">             </span><span class="k">do</span>
<span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="nb">verify</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">),</span><span class="s2">&quot;0123456789&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                   </span><span class="n">number_found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">                </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">number_found</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                   </span><span class="n">rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rank</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                   </span><span class="n">number_found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">                </span><span class="k">else</span>
<span class="k">                   </span><span class="n">rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                   </span><span class="k">exit</span>
<span class="k">                end if</span>
<span class="k">                </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nb">len_trim</span><span class="p">(</span><span class="n">string</span><span class="p">))</span><span class="w"> </span><span class="k">exit</span>
<span class="k">             end do</span>
<span class="k">             if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">number_found</span><span class="p">)</span><span class="w"> </span><span class="n">rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">          </span><span class="k">end if</span>

<span class="k">       end function </span><span class="n">dimcount</span>

<span class="w">    </span><span class="k">end program </span><span class="n">NXbrowse</span>
</pre></div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <p>Have a Question? <a href="https://github.com/nexusformat/wiki/issues/new">Get help</a></p>
  </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><p>
 <a href="http://www.nexusformat.org/">
   <img src="https://raw.githubusercontent.com/nexusformat/NIAC/master/NeXus_Logo/NeXus_Logo_dark.svg" alt="NeXus"
        width="150"
        height="50"
   >
</a>
<br>NeXus is developed as an international standard by scientists and programmers representing major scientific
 facilities in Europe, Asia, Australia, and North America in order to facilitate greater cooperation in the
 analysis and visualization of neutron, x-ray, and muon data.
<br><a href="http://www.nexusformat.org/">Home</a>
<br><a href="https://github.com/nexusformat">GitHub Organisation</a>
<br>Â© 2025 <a href="http://www.nexusformat.org/NIAC.html">NIAC</a>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="NXbrowse.html" title="NXbrowse"
             >next</a></li>
        <li class="right" >
          <a href="NXaperture_and_Slits.html" title="NXaperture and Slits"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html"></a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NXbrowse.f90</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, NIAC.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>
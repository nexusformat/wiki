


<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>NIAC2006 TOF Group</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css?v=34905f61" />
    <link rel="stylesheet" type="text/css" href="_static/details_summary_hide.css?v=30df4bca" />
    <link rel="stylesheet" href="_static/blockquote.css" type="text/css" />
    <link rel="stylesheet" href="_static/rubric.css" type="text/css" />
    <script src="_static/documentation_options.js?v=b08bce9f"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="https://raw.githubusercontent.com/nexusformat/NIAC/master/NeXus_Logo/NeXus_Logo_dark_square.svg"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="NIAC2007 attendees" href="NIAC2007_attendees.html" />
    <link rel="prev" title="NIAC2006 Synchrotron Group" href="NIAC2006_Synchrotron_Group.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="NIAC2007_attendees.html" title="NIAC2007 attendees"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="NIAC2006_Synchrotron_Group.html" title="NIAC2006 Synchrotron Group"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html"></a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NIAC2006 TOF Group</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="niac2006-tof-group">
<h1>NIAC2006 TOF Group<a class="headerlink" href="#niac2006-tof-group" title="Link to this heading">¶</a></h1>
<section id="time-of-flight-working-group">
<h2>Time-of-Flight Working Group<a class="headerlink" href="#time-of-flight-working-group" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>[Freddie Akeroyd] (Freddie_Akeroyd.html “wikilink”)</p></li>
<li><p>[Franck Cecillon] (Franck_Cecillon.html “wikilink”)</p></li>
<li><p>[Ray Osborn] (Ray_Osborn.html “wikilink”)</p></li>
<li><p>[Peter Peterson] (Peter_Peterson.html “wikilink”)</p></li>
<li><p>[Thomas Proffen] (Thomas_Proffen.html “wikilink”)</p></li>
<li><p>[Jiro Suzuki] (Jiro_Suzuki.html “wikilink”)</p></li>
</ul>
<p>This group was charged with discussing matters arising from the [NXTOFRW</p>
<ul class="simple">
<li><p>NeXus Time-of-Flight Raw File Format (simple sit and count
case)](TOFRaw.html “wikilink”) proposal in preparation for a full group
discussion.</p></li>
</ul>
</section>
<section id="summary-of-main-proposals-in-tofraw">
<h2>Summary of main proposals in <a class="reference external" href="TOFRaw.html" title="wikilink">TOFRaw</a><a class="headerlink" href="#summary-of-main-proposals-in-tofraw" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Some new meta-data names in NXentry for archiving and cataloguing of
data</p></li>
<li><p>Some thoughts about scans (now moved to
<a class="reference external" href="TOFRawScan.html" title="wikilink">NXTOFRWSC</a> and being considered by the
[Scanning Group] (Scanning_Group.html “wikilink”))</p></li>
<li><p>General and Area detector specific NXdetector</p></li>
<li><p>Additional options for specifying pixel geometry with area detectors
(edges, corners, etc.)</p></li>
<li><p>New NXdetector_groups class for logically grouping and labelling
detector elements</p></li>
<li><p>Representing hardware ganging of detectors</p></li>
</ol>
</section>
<section id="general-linear-and-area-detector-specific-nxdetector">
<h2>General, linear and Area detector specific NXdetector<a class="headerlink" href="#general-linear-and-area-detector-specific-nxdetector" title="Link to this heading">¶</a></h2>
<p>In all the definitions below we will leave out the Time-of-flight array
index as what we are discussing is equally valid for non time-of-flight
instruments. One new member of type NXgeometry called <strong>origin</strong> is
introduced into all NXdetectors - this member is used to define a
logical centre of the detector and its [NXshape] (NXshape.html “wikilink”)
member defines a bounding box for the whole detector bank/array. If the
[NXgeometry] (NXgeometry.html “wikilink”) instance <strong>geometry</strong> within
NXdetector is used to specify pixel locations, it should be define
positions relative to this detector origin.</p>
<section id="inheritance-of-definitions">
<h3>Inheritance of definitions<a class="headerlink" href="#inheritance-of-definitions" title="Link to this heading">¶</a></h3>
<p>To aid with making definitions clearer we spent some time considereing
an inheritance system for NeXus. One method would be to use a period (.)
in a class name to denote inheritance and so define classes called
NXdetector.area and NXdetector.point which would imply they inherited
from NXdetector. The API would need a minor change so that is you asked
for <strong>getnext(“NXdetector”)</strong> it would not look for an exact match of
this string, but look for any NeXus class that started with the prefix
“detector” and so would return either an NXdetector.area or
NXdetector.point etc. By using this (.) method the reading API does not
need to know about separately about the inheritance structure as it is
encoded in the name of the item when it is written by the API.</p>
<p>Though we would not introduce such inheritance into the API at thois
instance, it is something that is needed. For the moment we will just
have an NXdetector with the <strong>layout</strong> variable indicating the type
(area, point or linear)</p>
</section>
<section id="nxgeometry-revisited">
<h3>NXgeometry revisited<a class="headerlink" href="#nxgeometry-revisited" title="Link to this heading">¶</a></h3>
<p>Before giving the definitions a quick recap of
<a class="reference external" href="NXgeometry_and_NXshape_-_documentation_and_review.html" title="wikilink">NXgeometry</a> is in order. This class, through its
members [NXtranslation] (NXtranslation.html “wikilink”),
[NXorientation] (NXorientation.html “wikilink”) and
<a class="reference external" href="NXgeometry_and_NXshape_-_documentation_and_review.html" title="wikilink">NXshape</a>, allows the position, orientation and
physical extent (size) of an object, or set of objects, to be specified.
Translation and orientation can be relative i.e. with respect to an
arbitrary origin whihc is just another
<a class="reference external" href="NXgeometry_and_NXshape_-_documentation_and_review.html" title="wikilink">NXgeometry</a> object which defines a point in
space and a set of default axes directions. When we write
<strong>NXgeometry[i]</strong> in the definitions below we do not mean an array of
NXgeometry object (which is not allowed by NeXus) - instead we are using
this as shorthand for indexing the <strong>numobj</strong> array dimension the
[NXtranslation] (NXtranslation.html “wikilink”),
[NXorientation] (NXorientation.html “wikilink”) and
[NXshape] (NXgeometry_and_NXshape_-<em>documentation_and_review.html “wikilink”) objects within the
[NXgeometry] (NXgeometry_and_NXshape</em>-_documentation_and_review.html “wikilink”)</p>
</section>
<section id="type-1-point-detector">
<h3>Type 1: Point Detector<a class="headerlink" href="#type-1-point-detector" title="Link to this heading">¶</a></h3>
<p>A point detector is the most general case and represents a collection of
pixels <strong>i</strong> over some surface. Within the NXdetector all pixels
properties would be indxed by <strong>i</strong> e.g.:</p>
<ul class="simple">
<li><p>NX_CHAR layout = “point” (Really an Enum)</p></li>
<li><p>NX_INT counts[i]</p></li>
<li><p>NX_FLOAT polar_angle[i]</p></li>
<li><p>NX_FLOAT distance[i]</p></li>
<li><p>NX_FLOAT solid_angle[i]</p></li>
</ul>
<p>If desired, additional information about each pixel (shape, engineering
position) can be added via an</p>
<ul class="simple">
<li><p>NXgeometry geometry[i] # for each pixel</p></li>
</ul>
<p>instance <strong>geometry</strong>. Any detector can be represented by this general
case, though in the case of e.g. flat rectangualar detectors it is
useful to make use of simplifications introduced by this topology (see
below).</p>
</section>
<section id="type-2-linear-detector">
<h3>Type 2: linear Detector<a class="headerlink" href="#type-2-linear-detector" title="Link to this heading">¶</a></h3>
<p>Here we mean a collection of linear straight strips e.g. tubes. We have
two indicies: <strong>j</strong> will label the strip/tube and <strong>i</strong> the position
along the tube. All tubes must have the same number of pixels; if not,
you must use the point detector representation above. The tubes do not
need to be parallel - they just need to be straight. Thus:</p>
<ul class="simple">
<li><p>NX_CHAR layout = “linear” (Really an Enum)</p></li>
<li><p>NX_INT counts[j,i]</p></li>
<li><p>NX_FLOAT polar_angle[j,i]</p></li>
<li><p>NX_FLOAT distance[j,i]</p></li>
<li><p>NX_FLOAT solid_angle[j,i]</p></li>
</ul>
<p>So far this just looks like the point detector, but with two array
indices rather than one. However when we start adding geometry
information the differences become more clear. As the tubes are straight
we need only specify a location of the tube centre and an offset along
the tube. Thus:</p>
<ul class="simple">
<li><p>NXgeometry geometry[j] # defines tube/strip centre; each NXshape
member give the tube size and shape; each NXorientation member
rotates the axes such that <strong>x</strong> points along each tube.</p></li>
<li><p>pixel_offset[i] # offset from tube centre of each pixel centre</p></li>
<li><p>pixel_size[i] # size of each pixel</p></li>
</ul>
</section>
<section id="type-3-area-detector">
<h3>Type 3: Area Detector<a class="headerlink" href="#type-3-area-detector" title="Link to this heading">¶</a></h3>
<p>Here we have a rectangle for which each position can be defined by two
indices: <strong>i</strong> will label the pixel along the local detector <strong>x</strong> axis
and <strong>j</strong> the pixel along the local y axis. Using a third index <strong>k</strong>
allows us to represent a group of such detectors so:</p>
<ul class="simple">
<li><p>NX_CHAR layout = “area” (Really an Enum)</p></li>
<li><p>NX_INT counts[k,j,i]</p></li>
<li><p>NX_FLOAT polar_angle[k,j,i]</p></li>
<li><p>NX_FLOAT distance[k,j,i]</p></li>
<li><p>NX_FLOAT solid_angle[k,j,i]</p></li>
</ul>
<p>As the detector is a rectangle we just need to specdify x and y offsets
from the centre to indicate each pixel. Thus:</p>
<ul class="simple">
<li><p>NXgeometry geometry[k] defines each detector centre and extent</p></li>
<li><p>pixel_offset_x[k,i] # offset from detector centre of each
pixel’s x centre</p></li>
<li><p>pixel_offset_y[k,j] # offset from detector centre of each
pixel’s y centre</p></li>
<li><p>pixel_size_x[k,i] # x extent of pixel</p></li>
<li><p>pixel_size_y[k,j] # y extent of pixel</p></li>
</ul>
</section>
</section>
<section id="hardware-detector-ganging">
<h2>Hardware detector ganging<a class="headerlink" href="#hardware-detector-ganging" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="TOFRaw.html" title="wikilink">TOFRaw</a> originally suggested using an <strong>_unganged</strong>
suffix on the ungrouped elements e.g. polar_angle_unganged. It was
decided that creating a substructure within the NXdetector and putting
the information there was better so we will now have e.g.</p>
<ul class="simple">
<li><p>detector.counts[i] - grouped values</p></li>
<li><p>detector.polar_angle[i] - grouped values</p></li>
<li><p>detector.detector_number[i] - identifier for each grouped
detector</p></li>
<li><p>detector.gang.polar_angle[j] - raw values</p></li>
<li><p>detector.gang.detector_number[j] - identifier for each raw
detector</p></li>
</ul>
<p>As for showing the mapping scheme, a simple scheme would be</p>
<ul class="simple">
<li><p>detector.gang.grouping[j] - gives the grouped value <strong>i</strong>
appropriate for each detector element <strong>j</strong> (only allows 1-&gt;1
mapping)</p></li>
</ul>
<!-- -->
<ul class="simple">
<li><p>An alternative is the gang_count and gang_index method in
<a class="reference external" href="TOFRaw.html" title="wikilink">TOFRaw</a>, but this does require sorting of the
polar_angle etc. arrays prior to writing to the file</p></li>
</ul>
</section>
<section id="proposals">
<h2>Proposals<a class="headerlink" href="#proposals" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>That the new data items in required in NXentry and NXuser for
archiving be ratified. [Laurent
Lerusse] (L.lerusse.html “wikilink”) has volunteered to produce a
description such that any instruement definition that wishes can
“conform to” this.</p></li>
<li><p>That NeXus implement inheritance in definitions and classes by a
method yet to be finalised.</p></li>
<li><p>That the three types of detector representation are accepted</p></li>
</ol>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">NIAC2006 TOF Group</a><ul>
<li><a class="reference internal" href="#time-of-flight-working-group">Time-of-Flight Working Group</a></li>
<li><a class="reference internal" href="#summary-of-main-proposals-in-tofraw">Summary of main proposals in TOFRaw</a></li>
<li><a class="reference internal" href="#general-linear-and-area-detector-specific-nxdetector">General, linear and Area detector specific NXdetector</a><ul>
<li><a class="reference internal" href="#inheritance-of-definitions">Inheritance of definitions</a></li>
<li><a class="reference internal" href="#nxgeometry-revisited">NXgeometry revisited</a></li>
<li><a class="reference internal" href="#type-1-point-detector">Type 1: Point Detector</a></li>
<li><a class="reference internal" href="#type-2-linear-detector">Type 2: linear Detector</a></li>
<li><a class="reference internal" href="#type-3-area-detector">Type 3: Area Detector</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hardware-detector-ganging">Hardware detector ganging</a></li>
<li><a class="reference internal" href="#proposals">Proposals</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <p>Have a Question? <a href="https://github.com/nexusformat/wiki/issues/new">Get help</a></p>
  </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><p>
 <a href="http://www.nexusformat.org/">
   <img src="https://raw.githubusercontent.com/nexusformat/NIAC/master/NeXus_Logo/NeXus_Logo_dark.svg" alt="NeXus"
        width="150"
        height="50"
   >
</a>
<br>NeXus is developed as an international standard by scientists and programmers representing major scientific
 facilities in Europe, Asia, Australia, and North America in order to facilitate greater cooperation in the
 analysis and visualization of neutron, x-ray, and muon data.
<br><a href="http://www.nexusformat.org/">Home</a>
<br><a href="https://github.com/nexusformat">GitHub Organisation</a>
<br>© 2025 <a href="http://www.nexusformat.org/NIAC.html">NIAC</a>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="NIAC2007_attendees.html" title="NIAC2007 attendees"
             >next</a></li>
        <li class="right" >
          <a href="NIAC2006_Synchrotron_Group.html" title="NIAC2006 Synchrotron Group"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html"></a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NIAC2006 TOF Group</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, NIAC.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>
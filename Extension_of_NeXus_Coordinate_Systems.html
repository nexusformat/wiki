


<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Extension of NeXus Coordinate Systems</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css?v=34905f61" />
    <link rel="stylesheet" type="text/css" href="_static/details_summary_hide.css?v=30df4bca" />
    <link rel="stylesheet" href="_static/blockquote.css" type="text/css" />
    <link rel="stylesheet" href="_static/rubric.css" type="text/css" />
    <script src="_static/documentation_options.js?v=b08bce9f"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="icon" href="https://raw.githubusercontent.com/nexusformat/NIAC/master/NeXus_Logo/NeXus_Logo_dark_square.svg"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Facilities" href="Facilities.html" />
    <link rel="prev" title="Download" href="Download.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="Facilities.html" title="Facilities"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="Download.html" title="Download"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html"></a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Extension of NeXus Coordinate Systems</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="extension-of-nexus-coordinate-systems">
<h1>Extension of NeXus Coordinate Systems<a class="headerlink" href="#extension-of-nexus-coordinate-systems" title="Link to this heading">¶</a></h1>
<section id="extension-of-the-nexus-coordinate-systems">
<h2>Extension of the NeXus Coordinate Systems<a class="headerlink" href="#extension-of-the-nexus-coordinate-systems" title="Link to this heading">¶</a></h2>
<p>This suggestion results from comparing imageCIF with NeXus. Ideally we
should be able to make a mapping from CIF to NeXus. Unfortunately, NeXus
had some weaknesses in coordinate systems (addressed by this proposal)
and scaled data. Please note, that this proposal extends in what we
already do in NeXus and does not invalidate earlier efforts.</p>
<p>The CIF way of specifying axis is far more accurate then what we do with
NeXus. Thus the suggestion is to align NeXus with the well thought out
CIF scheme. This section consists first of a discussion of the CIF axis
system and then of suggestions how to use this within NeXus.</p>
<p>CIF uses a coordinate system which is similar to the McStas coordinate
system which NeXus uses at its bottom. Just the orientation of the
Z-axis differs. The description of any given axis in CIF consists of
three elements:</p>
<ul class="simple">
<li><p>The type of the axis. This can be translation or rotation</p></li>
<li><p>The axis vector. This is the direction of a translation or the
vector around which the axis rotates.</p></li>
<li><p>The axis offset. The offset to the base of the rotation or
translation. If this is not given 0,0,0 is assumed.</p></li>
</ul>
<p>CIF also describes in which order transformations have to be applied to
get a component into its final position from its zero position. In CIF
this is done by chaining axis through the depends attribute.</p>
<p>This scheme is a generalisation of the methods used commonly in
crystallography. There a crystal is brought into scattering position by
applying a series of rotations. Please note that order is important!</p>
<section id="axis-suggestions-for-nexus">
<h3>Axis Suggestions for NeXus<a class="headerlink" href="#axis-suggestions-for-nexus" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>NeXus stays with the McStas coordinate system.</p></li>
<li><p>NeXus uses the vector and offset scheme to document existing NeXus
axis. The base of all operations is always the component, if not
specified by an offset vector. Rotations are in degree, translations in
milimetre.</p></li>
</ol>
<p>Some examples:</p>
<ul class="simple">
<li><p>rotation_angle has a vector 0 1 0, rotation around Y</p></li>
<li><p>azimuthal_angle is a rotation around Z, vector = 0 0 1</p></li>
<li><p>polar_angle is also a rotation around Y, vector 0 1 0, but as the
rotation axis is with the previous component upstream, we have an
offset of 0 0 -distance</p></li>
</ul>
<p>In NXsample we additionally have:</p>
<ul class="simple">
<li><p>chi is a rotation around Z, vector 0 0 1</p></li>
<li><p>phi is a rotation around Y, vector 0 1 0</p></li>
<li><p>kappa, for kappa the vector attribute has to be given as there are
kappa goniometres with different values of kappa.</p></li>
</ul>
<ol class="arabic" start="3">
<li><p>Each NeXus component can have an additional field with the name
transform. This contains a komma separated list of the operations
required to place the component at its position in the instrument. The
formula is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>   Xcurrent = op1*op2....*opn * X0
</pre></div>
</div>
</li>
</ol>
<p>with transform becoming: op1,op2,….,opn Names of operations are the
names of the axis to apply. Unqualified names relate to axis in the same
group. In order to refer axis outside the current group, full path names
must be given. Storing this separatly in a transform field gives direct
access whereas the CIF depends system requires a lot of searches to
reconstruct the sequence of transforms. This is why I like transform
better.</p>
<p>In this description, our NeXus polar coordinate system has the
transform:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>          azimuthal_angle, polar_angle
</pre></div>
</div>
<p>This is also the default if the transform field is missing.</p>
<ol class="arabic simple" start="4">
<li><p>NeXus strongly prefers to use the NeXus simple coordinate system with
polar_angle and azimuthal_angle as describe above. This description
has the advantage that polar_angle is always two theta.</p></li>
<li><p>With the vector/offset scheme arbitrary axis can be stored in NeXus.
The rule then is that type, vector and offset have to be specified as
attributes. Type is NX_CHAR, vector and offset are of dim 3 and type
NX_FLOAT. We need these attributes anyway as there are angles such as
kappa, which differ in their rotation axis between instruments.</p></li>
<li><p>NeXus is missing a rotation around the X axis. As we already bought
into quite lyrical names for rotation axis I suggest aequatorial_angle
as a name for this.</p></li>
<li><p>Consequently, as NeXus does not have fields for describing
translations, except in Nxgeometry, I suggest to add x_translation,
y_translation and z_translation fields to each component. I choose to
suggest separate fields for the translations as they frequently map to
dedicated motors. Please note that all angles have to be 0 if you were
to determine the operation of any given translation motor.</p></li>
<li><p>The orientation field in NXgeometry receives the same meaning as
vector in axis descriptions. With vector being aligned with the main
axis of the component.</p></li>
<li><p>NXgeometry stays as is as a means to describe shapes, engineering
coordinates of orientations of components.</p></li>
</ol>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>01/2015: CIF style coordinate system descriptions have been ratified by
NIAC in 2012. The ratified version differs in many details, but not in
the approach, from the material on this page. Please consult a recent
copy of the NeXus manual for an update to date description of NeXus
coordinate descriptions.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Extension of NeXus Coordinate Systems</a><ul>
<li><a class="reference internal" href="#extension-of-the-nexus-coordinate-systems">Extension of the NeXus Coordinate Systems</a><ul>
<li><a class="reference internal" href="#axis-suggestions-for-nexus">Axis Suggestions for NeXus</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <p>Have a Question? <a href="https://github.com/nexusformat/wiki/issues/new">Get help</a></p>
  </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><p>
 <a href="http://www.nexusformat.org/">
   <img src="https://raw.githubusercontent.com/nexusformat/NIAC/master/NeXus_Logo/NeXus_Logo_dark.svg" alt="NeXus"
        width="150"
        height="50"
   >
</a>
<br>NeXus is developed as an international standard by scientists and programmers representing major scientific
 facilities in Europe, Asia, Australia, and North America in order to facilitate greater cooperation in the
 analysis and visualization of neutron, x-ray, and muon data.
<br><a href="http://www.nexusformat.org/">Home</a>
<br><a href="https://github.com/nexusformat">GitHub Organisation</a>
<br>© 2025 <a href="http://www.nexusformat.org/NIAC.html">NIAC</a>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="Facilities.html" title="Facilities"
             >next</a></li>
        <li class="right" >
          <a href="Download.html" title="Download"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html"></a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Extension of NeXus Coordinate Systems</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, NIAC.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
    </div>
  </body>
</html>
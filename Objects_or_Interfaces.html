


<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Objects or Interfaces</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css?v=34905f61" />
    <link rel="stylesheet" type="text/css" href="_static/details_summary_hide.css?v=30df4bca" />
    <link rel="stylesheet" href="_static/blockquote.css" type="text/css" />
    <link rel="stylesheet" href="_static/rubric.css" type="text/css" />
    <script src="_static/documentation_options.js?v=b08bce9f"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="https://raw.githubusercontent.com/nexusformat/NIAC/master/NeXus_Logo/NeXus_Logo_dark_square.svg"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="OO-NeXus" href="OO-NeXus.html" />
    <link rel="prev" title="Object Oriented Interface" href="Object_Oriented_Interface.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="OO-NeXus.html" title="OO-NeXus"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="Object_Oriented_Interface.html" title="Object Oriented Interface"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html"></a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Objects or Interfaces</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="objects-or-interfaces">
<h1>Objects or Interfaces<a class="headerlink" href="#objects-or-interfaces" title="Link to this heading">¶</a></h1>
<p>There is a need to review the NeXus base classes. They confuse people
because of their unstructured representation of in some cases many, many
fields. I see two main ways how this can be accomplished: Object
orientation and Inheritance or Interfaces and Composition.</p>
<section id="object-orientation-and-inheritance">
<h2>Object Orientation and Inheritance<a class="headerlink" href="#object-orientation-and-inheritance" title="Link to this heading">¶</a></h2>
<p>This should be pretty clear: we define an inheritance hierarchy of base
classes. For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXarea_detector:NXdetector:NXbeamline_component
</pre></div>
</div>
<p>would mean NXarea_detector inherits from NXdetector and from
NXbeamline_component.</p>
<p>Choosing such a solution has a couple of consequences:</p>
<ul class="simple">
<li><p>We would need to define a great number of new NeXus base classes.
This can be even more confusing.</p></li>
<li><p>It is not clear how inheritance can be represented in a data file.</p></li>
<li><p>The OO concept does not fit well:</p>
<ul>
<li><p>Normally OO means encapsulating behaviour with data. NeXus has
no behaviour, only data</p></li>
<li><p>Some people say OO is really about message passing. There are no
messages (yet) in NeXus</p></li>
</ul>
</li>
<li><p>I can imagine situations when single inheritance is not enough and
we need to deal with multiple inheritance. With all its ugliness.</p></li>
</ul>
</section>
<section id="interfaces-and-composition">
<h2>Interfaces and Composition<a class="headerlink" href="#interfaces-and-composition" title="Link to this heading">¶</a></h2>
<p>This would imply that we define interfaces in addition to the base
classes. For example beamline_component, detector, area_detector etc.
A base class would then get an implements field or attribute which
details which interfaces the base class implements. To stay with the
example above: NXdetector would have an implements field with:
Iarea_detector:Ibeamline_component. A base class would then be defined
by the interfaces it can implement, plus mandatory data fields.</p>
<p>Such an approach has the following consequences:</p>
<ul class="simple">
<li><p>Backwards compatability is maintained. We add a new feature to
NeXus. No need to generate no new base classes.</p></li>
<li><p>No issues with multiple inheritance</p></li>
<li><p>An application can inspect the implements field and from this can
decide what type of detector/ component it is dealing with.</p></li>
<li><p>I have no clue how this can be mapped into NXDL</p></li>
</ul>
</section>
<section id="nexus-interfaces-a-possible-implementation">
<h2>NeXus Interfaces: A Possible Implementation<a class="headerlink" href="#nexus-interfaces-a-possible-implementation" title="Link to this heading">¶</a></h2>
<p>This is a more detailed outline how NeXus Interfaces might look in
advance of a vote on the issue</p>
</section>
<section id="the-problem">
<h2>The Problem<a class="headerlink" href="#the-problem" title="Link to this heading">¶</a></h2>
<p>Quite a number of NeXus base classes have become pretty big. This is due
to the fact that NeXus base classes are dictionaries which hold field
names for all sorts of data items which can be associated with a given
NeXus component.</p>
<p>A good example is NXdetector: it holds data items to describe all sorts
of detectors, single, area, arbitrarily shaped, with TOF or without etc.
Many users are confused by NeXus base classes because they mistakingly
think that they have to implement all data items even if they do not
make any sense for their application.</p>
<p>A better structure would clearly help here. One way to structure this
better would be inheritance. This would mean introducing more NeXus base
classes, for example:</p>
<p>NXsingle_detector, NXarea_detector, NXtof_area_detector etc which
form a hierarchy rooted at NXbeamline_component. The applicable fields
for a component would then be derived by travelling the hierarchy. This
comes at the expense of creating many more backwards incompatible
classes. Moreover the inheritance hierarchy cannot easily be encoded in
a HDF5 file. Thus a program looking for NXdetector would need to know
about all its incarnations from an external source. This raises issues
about the maintainability of the external sources.</p>
<p>The second option to be discussed is to use interfaces, like in Java or
Go. This is a separate set of finer grained dictionaries which are used
to build up the NeXus base classes.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<p>How could the interface method look like for NXdetector? To this purpose
let us define a set of interfaces to work this. I use the prefix NXIF
here for interfaces but this is perfectly arbitrary.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXIFbeamline\_component:  

   distance  
     @type=translation  
     @vector=0,0,1  
   height  
     @type=translation  
     @vector=0,1,0  
   x_translation  
     @type=translation  
     @vector=1,0,0  
   rotation_angle  
     @type=rotation  
     @vector=0,1,0  
   azimuthal_angle  
     @type=rotation  
     @vector=0,0,1  
   meridional_angle  
     @type=rotation  
     @vector=1,0,0
</pre></div>
</div>
<p>This is an interface meant to be implemented by all beamline components.
Its purpose is to position the component.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXIFmeta:  

  type  
  description
</pre></div>
</div>
<p>An interface which contains general meta data about anything</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXIFsingle:  

   data  
     @signal=1
</pre></div>
</div>
<p>A simple interface for data from a single detector</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXIFscanned\_single:  

   data[NP]  
     @signal=1
</pre></div>
</div>
<p>A single detector scanned. NP is the number of scan points</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXIFarea\_detector:  

   data[xdim,ydim]  
     @signal=1  
     @axes=x_pixel_offset,y_pixel_offset  
   x_pixel_offset[xdim]  
     @type=translation  
     @vector=1,0,0  
   x_pixel_size[xdim]      
   y_pixel_offset[ydim]  
     @type=translation  
     @vector=0,1,0  
   y_pixel_size[ydim]    
</pre></div>
</div>
<p>An interface for an area detector. x_pixel_offset and y_pixel_offset
describe the grid of the detector in the detector coordinate system. The
origin is the mechanical center of the area detector. If the pixel sizes
cannot be determined from the grid span by x_pixel_offset and
y_pixel_offset, they are given in x,y_pixel_size.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXIFscanned\_area\_detector:  

   data[NP,xdim,ydim]  
     @signal=1  
     @axes=scan_axis,x_pixel_offset,y_pixel_offset  
   x_pixel_offset[xdim]  
     @type=translation  
     @vector=1,0,0  
   x_pixel_size[xdim]      
   y_pixel_offset[ydim]  
     @type=translation  
     @vector=0,1,0  
   y_pixel_size[ydim]    
</pre></div>
</div>
<p>An interface for a scanned area detector. The meaning of
x,y_pixel_offset etc are the same as above. One might consider to
allow inheritance for Interfaces.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXIFtof\_area\_detector:  

   data[xdim,ydim,ntbin]  
     @signal=1  
     @axes=x_pixel_offset,y_pixel_offset,time_binning  
   x_pixel_offset[xdim]  
     @type=translation  
     @vector=1,0,0  
   x_pixel_size[xdim]      
   y_pixel_offset[ydim]  
     @type=translation  
     @vector=0,1,0  
   y_pixel_size[ydim]      
   time_binning[ntbin]
</pre></div>
</div>
<p>An interface for an area detector used in time of flight mode.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXIF\_arbitrary\_detector:  

   data[ndet]  
     @signal=1  
   distance[ndet]  
     @type=translation  
     @vector=0,0,1  
   height[ndet]  
     @type=translation  
     @vector=0,1,0  
   x_translation[ndet]  
     @type=translation  
     @vector=1,0,0  
   rotation_angle[ndet]  
     @type=rotation  
     @vector=0,1,0  
   azimuthal_angle[ndet]  
     @type=rotation  
     @vector=0,0,1  
   meridional_angle[ndet]  
     @type=rotation  
     @vector=1,0,0  
</pre></div>
</div>
<p>This is an interface to describe a highly irregular detector. A detector
which can only be described by giving full positional and rotational
coordinates for each detector element. ISIS has this kind of detectors.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXIFtof\_arbitrary\_detector:  

   data[ndet,ntbin]  
     @signal=1  
   distance[ndet]  
     @type=translation  
     @vector=0,0,1  
   height[ndet]  
     @type=translation  
     @vector=0,1,0  
   x_translation[ndet]  
     @type=translation  
     @vector=1,0,0  
   rotation_angle[ndet]  
     @type=rotation  
     @vector=0,1,0  
   azimuthal_angle[ndet]  
     @type=rotation  
     @vector=0,0,1  
   meridional_angle[ndet]  
     @type=rotation  
     @vector=1,0,0  
   time_binning[ntbin]
</pre></div>
</div>
<p>This is an interface to describe a highly irregular detector used in
time of flight mode. The rest is shared with above.</p>
<p>To be continued…………………….</p>
</section>
<section id="how-to-use-such-interfaces">
<h2>How to use such Interfaces<a class="headerlink" href="#how-to-use-such-interfaces" title="Link to this heading">¶</a></h2>
<p>Of course there have to be rules how to use NeXus Interfaces. The rule
set is simple:</p>
<ol class="arabic simple">
<li><p>A group attribute implements is added which is a komma separated
list of the interfaces implemented by the component.</p></li>
<li><p>The software can then expect the fields defined by the interfaces to
appear in the component class. If this is must or optional is to be
discussed.</p></li>
<li><p>A given NeXus base class can only implement a sensible set of
interfaces. It would be dubious if NXdetector implements
NXIFspallation_neutron_source.</p></li>
</ol>
<p>An example is in order. Consider:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXdetector  
 @implements NXIFbeamline_component,NXIFarea_detector
</pre></div>
</div>
<p>Then the following fields go into NXdetector:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXdetector  
 @implements NXIFbeamline_component,NXIFarea_detector  
   distance  
     @type=translation  
     @vector=0,0,1  
   height  
     @type=translation  
     @vector=0,1,0  
   x_translation  
     @type=translation  
     @vector=1,0,0  
   rotation_angle  
     @type=rotation  
     @vector=0,1,0  
   azimuthal_angle  
     @type=rotation  
     @vector=0,0,1  
   meridional_angle  
     @type=rotation  
     @vector=1,0,0  
   data[NP,xdim,ydim]  
     @signal=1  
     @axes=scan_axis,x_pixel_offset,y_pixel_offset  
   x_pixel_offset[xdim]  
     @type=translation  
     @vector=1,0,0  
   x_pixel_size[xdim]      
   y_pixel_offset[ydim]  
     @type=translation  
     @vector=0,1,0  
   y_pixel_size[ydim]    
</pre></div>
</div>
<p>Another example: a scanned single detector</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NXdetector  
 @implements NXIFbeamline_component, NXIFscanned_single_detector  
   distance  
     @type=translation  
     @vector=0,0,1  
   height  
     @type=translation  
     @vector=0,1,0  
   x_translation  
     @type=translation  
     @vector=1,0,0  
   rotation_angle  
     @type=rotation  
     @vector=0,1,0  
   azimuthal_angle  
     @type=rotation  
     @vector=0,0,1  
   meridional_angle  
     @type=rotation  
     @vector=1,0,0  
   data[NP]  
     @signal=1
</pre></div>
</div>
</section>
<section id="advantages-and-disadvantages">
<h2>Advantages and Disadvantages<a class="headerlink" href="#advantages-and-disadvantages" title="Link to this heading">¶</a></h2>
<section id="advantages">
<h3>Advantages<a class="headerlink" href="#advantages" title="Link to this heading">¶</a></h3>
<p>What would be the advantages of the NeXus interface approach:</p>
<ul class="simple">
<li><p>We can be far more specific what goes into a base class for a use
case then with the current base class description.</p></li>
<li><p>We can do so without cluttering the namespace with even more base
classes.</p></li>
<li><p>User confusion is reduced.</p></li>
<li><p>The approach is easily extended to new use cases by defining a new
interface for the new use case.</p></li>
<li><p>The interface approach is backwards compatible. We add to NeXus
rather then defining something entirely new. Old files can be
updated to the way of the interface by adding required fields and
the interface group attribute.</p></li>
</ul>
</section>
<section id="disadvantages">
<h3>Disadvantages<a class="headerlink" href="#disadvantages" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>It is yet another concept and set of rules to teach and learn.</p></li>
</ul>
</section>
</section>
<section id="nexus-interfaces-and-mapping-to-cif">
<h2>NeXus Interfaces and Mapping to CIF<a class="headerlink" href="#nexus-interfaces-and-mapping-to-cif" title="Link to this heading">¶</a></h2>
<p>When mapping between NeXus and CIF there is a major difficulty: the way
how multiples are handled in CIF and NeXus. Consider an instrument with
two detectors. In NeXus this would map to two NXdetector classes and two
NXdata classes with different names within the hierarchy.</p>
<p>In CIF one would loop over detector name and all the fields of the base
class. A loop is basically a table. The above example would thus map to
a table with detector_name and all the fields of the base class as
columns and two rows indexed by detctor name.</p>
<p>With the current size of the NeXus base classes, this would make for
unwieldly and sparsely populated tables. With NeXus Interfaces this
becomes much more workable. Each NeXus interface would map to a CIF
category(table) and there would be other categories (tables) which
detail the list of components of the instrument and which interfaces are
implemented by each component.</p>
<p>Herbert solved the problem in his concordance document by appending the
NeXus base class name and the component name together. But this makes
for long and unpredictable CIF category (table) names.</p>
</section>
<section id="where-to-go-from-here">
<h2>Where To Go From Here?<a class="headerlink" href="#where-to-go-from-here" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>All the confusion generated by this document must be resolved.</p></li>
<li><p>The big thing is: do we want NeXus Interfaces? This requires a vote.</p></li>
<li><p>Which rules do we use to write NeXus Interfaces. I made something up
for the this example. But, of course, this could be different.</p></li>
<li><p>How do we document NeXus interfaces? NXDL would be the first call,
but…..</p></li>
<li><p>Polishing up NeXus interfaces most likely requires a code camp.</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="more-on-interfaces">
<h2>More on Interfaces<a class="headerlink" href="#more-on-interfaces" title="Link to this heading">¶</a></h2>
<p>There is a branch, interfaces, on the nexus definitions github area
which generates a version of the NeXus manual with Interfaces fully
worked out. Well, how it should look like in my humble opinion.</p>
</section>
<section id="update-01-2015">
<h2>Update: 01/2015<a class="headerlink" href="#update-01-2015" title="Link to this heading">¶</a></h2>
<p>At NIAC 2014 it was decided to accept NeXus Interfaces as an
experimental feature. This means that a special section of the manual
will be written which uses interfaces. This section will be clearly
labelled as experimental.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Objects or Interfaces</a><ul>
<li><a class="reference internal" href="#object-orientation-and-inheritance">Object Orientation and Inheritance</a></li>
<li><a class="reference internal" href="#interfaces-and-composition">Interfaces and Composition</a></li>
<li><a class="reference internal" href="#nexus-interfaces-a-possible-implementation">NeXus Interfaces: A Possible Implementation</a></li>
<li><a class="reference internal" href="#the-problem">The Problem</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#how-to-use-such-interfaces">How to use such Interfaces</a></li>
<li><a class="reference internal" href="#advantages-and-disadvantages">Advantages and Disadvantages</a><ul>
<li><a class="reference internal" href="#advantages">Advantages</a></li>
<li><a class="reference internal" href="#disadvantages">Disadvantages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nexus-interfaces-and-mapping-to-cif">NeXus Interfaces and Mapping to CIF</a></li>
<li><a class="reference internal" href="#where-to-go-from-here">Where To Go From Here?</a></li>
<li><a class="reference internal" href="#more-on-interfaces">More on Interfaces</a></li>
<li><a class="reference internal" href="#update-01-2015">Update: 01/2015</a></li>
</ul>
</li>
</ul>

  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <p>Have a Question? <a href="https://github.com/nexusformat/wiki/issues/new">Get help</a></p>
  </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><p>
 <a href="http://www.nexusformat.org/">
   <img src="https://raw.githubusercontent.com/nexusformat/NIAC/master/NeXus_Logo/NeXus_Logo_dark.svg" alt="NeXus"
        width="150"
        height="50"
   >
</a>
<br>NeXus is developed as an international standard by scientists and programmers representing major scientific
 facilities in Europe, Asia, Australia, and North America in order to facilitate greater cooperation in the
 analysis and visualization of neutron, x-ray, and muon data.
<br><a href="http://www.nexusformat.org/">Home</a>
<br><a href="https://github.com/nexusformat">GitHub Organisation</a>
<br>© 2025 <a href="http://www.nexusformat.org/NIAC.html">NIAC</a>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="OO-NeXus.html" title="OO-NeXus"
             >next</a></li>
        <li class="right" >
          <a href="Object_Oriented_Interface.html" title="Object Oriented Interface"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html"></a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Objects or Interfaces</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, NIAC.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>